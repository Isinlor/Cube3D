<canvas id="canvas1" width="800" height="800"></canvas>
<script>
function setPixel(imageData, x, y, rgb=[0,0,0], a = 255) {
    index = (x + y * imageData.width) * 4;
    imageData.data[index+0] = rgb[0];
    imageData.data[index+1] = rgb[1];
    imageData.data[index+2] = rgb[2];
    imageData.data[index+3] = a;
    return;
}
function drawLine(point1, point2) {
	var firstPoint = point1;
	var secondPoint = point2;
	console.log('Draw line:', firstPoint, secondPoint);
	if (secondPoint[1] == firstPoint[1] && secondPoint[0] == firstPoint[0]) {
    	setPixel(imageData, secondPoint[1], secondPoint[0]);
	} else {
		var dx = firstPoint[1] - secondPoint[1]; 
		var sx = (dx < 0) ? -1 : 1;
		var dy = firstPoint[0] - secondPoint[0]; 
		var sy = (dy < 0) ? -1 : 1;

		if (Math.abs(dy) < Math.abs(dx))
		{    
		    var a = dy / dx;
		    var b = secondPoint[0] - a * secondPoint[1];
		    var i = secondPoint[1];
		    while (i != firstPoint[1])
		    {
		        setPixel(imageData, Math.round(a*i + b), i);
		        i += sx;
		    }
		} 
		else 
		{
		    var a = dx / dy;
		    var b = secondPoint[1] - a * secondPoint[0];
		    var i = secondPoint[0];
		    while (i != firstPoint[0])
		    {
		        setPixel(imageData, i, Math.round(a*i + b));
		        i += sy;
		    }    
		}
	}
	return;
}
function drawTriangle(triangle){
	drawLine(triangle[0], triangle[1]);
	drawLine(triangle[1], triangle[2]);
	drawLine(triangle[2], triangle[0]);
}
function translateTriangle(triangle, x, y) {
	for (var i = triangle.length - 1; i >= 0; i--) {
		triangle[i][0] = triangle[i][0]+x;
		triangle[i][1] = triangle[i][1]+y;
	};
}
function rotatePoint (point, centerPoint, theta) {
	var cosTheta = Math.cos(theta);
	var sinTheta = Math.sin(theta);
	point[0] = point[0] - centerPoint[0];
	point[1] = point[1] - centerPoint[1];
    var p0 = point[0]*cosTheta-point[1]*sinTheta;
    var p1 = point[0]*sinTheta+point[1]*cosTheta;
	point[0] = p0;
	point[1] = p1;
	point[0] = Math.round(point[0] + centerPoint[0]);
	point[1] = Math.round(point[1] + centerPoint[1]);
}
function rotateTriangle (triangle, x, y, theta) {
	for (var i = triangle.length - 1; i >= 0; i--) {
		console.log("rotatePoint", i);
		rotatePoint(triangle[i], x, y, theta);
	};
}
function reset () {
	for (var i=0;i<imageData.data.length;i+=4) {
	  // imageData.data[i+0]=255;
	  // imageData.data[i+1]=255;
	  // imageData.data[i+2]=255;
	  imageData.data[i+3]=0;
    }
}
function draw () {
	reset();
	var A = [200, 300];
	var B = [300, 200];
	var C = [200, 200];
	var ABC = [A, B, C];
	translateTriangle(ABC, 200, 200);
	rotateTriangle(ABC, [400, 400], n);
	drawTriangle(ABC);
	c.putImageData(imageData, 0, 0);
	n = n + 0.1;
}
element = document.getElementById("canvas1");
c = element.getContext("2d");

// read the width and height of the canvas
width = element.width;
height = element.height;

// create a new pixel array
imageData = c.createImageData(width, height);
var A = [200, 300];
var B = [300, 200];
var C = [200, 200];
var ABC = [A, B, C];
var n = 0;

setInterval(draw, 10);

setPixel(imageData, 400, 400, [255,0,0]);
setPixel(imageData, 401, 401, [255,0,0]);
setPixel(imageData, 400, 401, [255,0,0]);
setPixel(imageData, 401, 400, [255,0,0]);
// copy the image data back onto the canvas
c.putImageData(imageData, 0, 0); // at coords 0,0
</script>